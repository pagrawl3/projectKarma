//var main = require('../../../app/controllers/main.js');
function loadScript(){var e=document.createElement("script");e.type="text/javascript";e.src="http://maps.googleapis.com/maps/api/js?key=AIzaSyDc4bUWerMbRWFK6oldh4vUBS2tiTyL5W8&sensor=true&callback=initialize";document.body.appendChild(e)}function clearOverlays(){for(var e=0;e<markersArray.length;e++)markersArray[e].setMap(null);markersArray=[]}function initialize(){console.log("Calling initialize for maps");var e={zoom:3,center:new google.maps.LatLng(50,-45),mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("map-canvas"),e);iconStar=new google.maps.MarkerImage("../img/icons/iconmonstr-location-16-icon.svg",null,null,null,new google.maps.Size(50,50));iconStarTwo=new google.maps.MarkerImage("../img/icons/iconmonstr-location-17-icon.svg",null,null,null,new google.maps.Size(50,50));infowindow=new google.maps.InfoWindow;console.log("Initialized Google Maps API");putAllMarkers()}function addMarker(e,t,n){var r=new google.maps.LatLng(e[1],e[0]),i=new google.maps.Marker({position:r,map:map,title:n});console.log(n);t=="ngo"?i.setIcon(iconStar):i.setIcon(iconStarTwo);markersArray.push(i);google.maps.event.addListener(i,"click",function(){var e='<h3 style="font-family:lato;font-weight:300">'+n+"</h3";infowindow.setContent(e);infowindow.open(map,i)});console.log("Marker added")}function putAllMarkers(){clearOverlays();var e=io.connect("/");console.log("In putallmarksers");e.emit("retrieveAll",{loc:0});e.on("retrieveAllSuccess",function(e){for(var t in e.result){console.log(e.result[t].body.coords);console.log(e.result[t].type);addMarker(e.result[t].body.coords,e.result[t].type,e.result[t].body.name)}})}function codeLoc(e,t){var n=new google.maps.Geocoder,r=[];n.geocode({address:e},function(e,n){if(n==google.maps.GeocoderStatus.OK){r[1]=e[0].geometry.location.lat();r[0]=e[0].geometry.location.lng();var i=io.connect("/");console.log(r);i.emit("searchByLocation",{loc:r,radius:5e4/3959});i.on("locationSearchSuccess",function(e){clearOverlays();for(var n in e.result){addMarker(e.result[n].body.coords,e.result[n].type,e.result[n].body.name);console.log(e.result[n].type)}t(e.result)})}else alert("Geocode was not successful for the following reason: "+n)})}function codeScale(e,t){var n=io.connect("/");n.emit("searchByScale",{scale:e});n.on("scaleSearchSuccess",function(e){clearOverlays();for(var n in e.result)addMarker(e.result[n].body.coords,e.result[n].type,e.result[n].body.name);console.log(e);t(e.result)})}function codeWork(e,t){var n=io.connect("/");n.emit("searchByWork",{keyword:e});n.on("workSearchSuccess",function(e){clearOverlays();console.log(e);for(var n in e.result)addMarker(e.result[n].body.coords,e.result[n].type,e.result[n].body.name);t(e.result)})}function findType(e,t){console.log("here");console.log(e);e.type=="loc"?codeLoc(e.value,t):e.type=="scale"?codeScale(parseInt(e.value),t):codeWork(e.value,t)}function display(e){alert(e)}var iconStar,iconStarTwo,infowindow,markersArray=[];